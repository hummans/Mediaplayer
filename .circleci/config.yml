version: 2.1
config: &config
  environment:
    TERM: dumb
    JAVA_TOOL_OPTIONS: "-Xmx2G"
    GRADLE_OPTS: "-Dorg.gradle.daemon=false -Dkotlin.incremental=false"


orbs:
  slack: circleci/slack@0.1.0
  android: circleci/android@0.2.1

jobs:
  build:
    <<: *config
    executor: android/android
    steps:
      - checkout
      - android/install-ndk:
          ndk-sha: "c81a5bcb4672a18d3647bf6898cd4dbcb978d0e8"
          ndk-version: android-ndk-r21c
      - run:
          name: "Cleaning Android"
          command: ./gradlew clean
      - run:
          name: "Building Android"
          command: ./gradlew assembleStageDebug --stacktrace
