version: 2.1
config: &config
  environment:
    TERM: dumb
    JAVA_TOOL_OPTIONS: "-Xmx2G"
    GRADLE_OPTS: "-Dorg.gradle.daemon=false -Dkotlin.incremental=false"


orbs:
  slack: circleci/slack@0.1.0
  android: circleci/android@0.2.1

jobs:
  build:
    <<: *config
    executor: android/android
    parameters:
      ndk-sha: fd94d0be6017c6acbd193eb95e09cf4b6f61b834
      ndk-version: android-ndk-r19c
    steps:
      - checkout
      - install-ndk
      - run:
          name: "Cleaning Android"
          command: ./gradlew clean
      - run:
          name: "Building Android"
          command: ./gradlew assembleStageDebug --stacktrace
